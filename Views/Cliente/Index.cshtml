
@model IEnumerable<ChallengeIntegra.Models.Cliente>

@{
    // Obtener el estado del filtro desde ViewData. Por defecto, solo mostrar activos.
    bool showInactive = (bool)(ViewData["ShowInactive"] ?? false);
    
    // Establezco el titulo de la pagina dinámicamente.
    ViewData["Title"] = showInactive ? "Histórico de Clientes (Inactivos)" : "Listado de Clientes (Activos)";
}

<h1>@ViewData["Title"]</h1>

<p class="d-flex justify-content-between align-items-center">
    @* Botón para crear un nuevo cliente *@
    <a asp-action="Create" class="btn btn-primary">Crear Nuevo Cliente</a>

    @* Botón para alternar la vista entre clientes activos e inactivos *@
    @if (showInactive)
    {
        <a asp-action="Index" asp-route-showInactive="false" class="btn btn-info">Ver Clientes Activos</a>
    }
    else
    {
        <a asp-action="Index" asp-route-showInactive="true" class="btn btn-secondary">Ver Histórico de Clientes (Inactivos)</a>
    }
</p>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.CUIT)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.RazonSocial)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Telefono)
            </th>
            @* Mostrar la columna "Activo" solo si estamos viendo clientes inactivos o el histórico *@
            @if (showInactive)
            {
                <th>
                    @Html.DisplayNameFor(model => model.Activo)
                </th>
            }
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.CUIT)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.RazonSocial)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Telefono)
            </td>
            @* Mostrar el estado 'Activo' solo si estamos viendo el histórico *@
            @if (showInactive)
            {
                <td>
                    @Html.DisplayFor(modelItem => item.Activo)
                </td>
            }
            <td>
                @* El botón "Editar" siempre está disponible *@
                <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-sm btn-warning">Editar</a> |
                <a asp-action="Details" asp-route-id="@item.Id" class="btn btn-sm btn-info">Detalles</a> 
                
                @* El botón "Eliminar" solo se muestra si el cliente está activo.
                   No se puede "eliminar" lógicamente un cliente que ya está inactivo. *@
                @if (!showInactive)
                {
                    <text> | <a asp-action="Delete" asp-route-id="@item.Id" class="btn btn-sm btn-danger">Eliminar</a></text>
                }
            </td>
        </tr>
}
    </tbody>
</table>
